<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<input type="text" placeholder="message" id="textbox">
<button id="button">Send</button>
<form>
    <input type="radio" name="channel" value="first" checked> First
    <input type="radio" name="channel" value="second"> Second<br>
</form>
<div id="box"></div>

<script>
    let channel = 'first';
    let socket = new WebSocket(`ws://localhost:8080/ws/${channel}`);

    let button = document.getElementById("button");
    button.addEventListener("click", () => {
        let text = document.getElementById("textbox").value;
        socket.send(text);
    });

    socket.onopen = () => {
        console.log("Socket opened successfully");
    };

    socket.onmessage = event => {
        let box = document.createElement("div");
        box.innerHTML = event.data;
        document.getElementById("box").appendChild(box);
    };

    window.onbeforeunload = () =>{
        socket.close();
    };

    const channelsRadios = document.getElementsByName('channel');
    channelsRadios.forEach((radio) => {
       radio.addEventListener('change', () => {
           changeChannel(radio.value);
       });
    });

    function changeChannel(channel) {
        socket.close();
        socket = new WebSocket(`ws://localhost:8080/ws/${channel}`);
    }
</script>
</body>
</html>
